<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê³¼ì œ ì œì¶œë¬¼ ê´€ë¦¬ - Ploytech</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #a8e6cf, #7fcdcd);
      font-family: 'Arial', sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .header {
      background-color: #7fcdcd;
      padding: 15px 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .header-left {
      display: flex;
      align-items: center;
    }

    .logo {
      width: 60px;
      height: 60px;
      background: #ffffff;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 15px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .logo::before {
      content: "ğŸ’¡";
      font-size: 24px;
    }

    .title {
      font-size: 28px;
      font-weight: bold;
      color: #2c3e50;
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 20px;
      color: #2c3e50;
      font-weight: bold;
    }

    .back-btn {
      background: #6c757d;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: background 0.3s;
      text-decoration: none;
    }

    .back-btn:hover {
      background: #5a6268;
    }

    .container {
      flex: 1;
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }

    .assignment-info {
      background: white;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.1);
      margin-bottom: 25px;
    }

    .assignment-title {
      font-size: 28px;
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 10px;
    }

    .assignment-meta {
      display: flex;
      gap: 30px;
      color: #7f8c8d;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    .meta-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .assignment-description {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      color: #5a6c7d;
      line-height: 1.6;
    }

    .stats-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.1);
      text-align: center;
    }

    .stat-number {
      font-size: 28px;
      font-weight: bold;
      color: #7fcdcd;
    }

    .stat-label {
      color: #7f8c8d;
      font-size: 14px;
      margin-top: 5px;
    }

    .submissions-table {
      background: white;
      border-radius: 15px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.1);
      overflow: hidden;
    }

    .table-header {
      background: #f8f9fa;
      padding: 20px;
      border-bottom: 1px solid #e9ecef;
    }

    .table-title {
      font-size: 20px;
      font-weight: bold;
      color: #2c3e50;
      margin: 0;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th, td {
      padding: 15px;
      text-align: left;
      border-bottom: 1px solid #e9ecef;
    }

    th {
      background: #f8f9fa;
      color: #2c3e50;
      font-weight: bold;
      font-size: 14px;
    }

    tr:hover {
      background: #f8f9fa;
    }

    .student-info {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .student-avatar {
      width: 35px;
      height: 35px;
      background: #7fcdcd;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 14px;
    }

    .student-details {
      display: flex;
      flex-direction: column;
    }

    .student-name {
      font-weight: bold;
      color: #2c3e50;
    }

    .student-id {
      font-size: 12px;
      color: #7f8c8d;
    }

    .submission-status {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: bold;
    }

    .status-submitted {
      background: #d4edda;
      color: #155724;
    }

    .status-graded {
      background: #cce5ff;
      color: #0066cc;
    }

    .status-late {
      background: #fff3cd;
      color: #856404;
    }

    .logout-btn {
        text-decoration: none;
        background: #e74c3c;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        transition: background 0.3s;
    }

    .logout-btn:hover {
        background: #c0392b;
    }

    .score-display {
      font-weight: bold;
      font-size: 16px;
    }

    .score-good {
      color: #28a745;
    }

    .score-average {
      color: #ffc107;
    }

    .score-poor {
      color: #dc3545;
    }

    .action-btn {
      background: linear-gradient(45deg, #7fcdcd, #a8e6cf);
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: bold;
      cursor: pointer;
      text-decoration: none;
      transition: transform 0.2s;
      margin-right: 5px;
    }

    .action-btn:hover {
      transform: translateY(-1px);
    }

    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #7f8c8d;
    }

    .empty-state-icon {
      font-size: 64px;
      margin-bottom: 20px;
    }

    .alert {
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .alert-success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .alert-danger {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f1aeb5;
    }

    @media (max-width: 768px) {
      .assignment-meta {
        flex-direction: column;
        gap: 10px;
      }

      .stats-cards {
        grid-template-columns: repeat(2, 1fr);
      }

      table {
        font-size: 14px;
      }

      th, td {
        padding: 10px 8px;
      }
    }
  </style>
</head>
<body>
<div class="header">
  <div class="header-left">
    <div class="logo"></div>
    <div class="title">Ploytech ê³¼ì œ ì œì¶œ ì‹œìŠ¤í…œ</div>
  </div>
  <div class="user-info">
    <span th:text="${professor.name + ' êµìˆ˜ë‹˜'}">êµìˆ˜ë‹˜</span>
    <a href="/professor/assignments" class="back-btn">â† ê³¼ì œ ëª©ë¡</a>
  </div>
</div>

<div class="container">
  <!-- Success/Error Messages -->
  <div th:if="${successMessage}" class="alert alert-success" th:text="${successMessage}"></div>
  <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>

  <!-- Assignment Info -->
  <div class="assignment-info">
    <div class="assignment-title" th:text="${assignment.title}">ê³¼ì œ ì œëª©</div>
    <div class="assignment-meta">
      <div class="meta-item">
        <span>ğŸ“š</span>
        <span th:text="${assignment.course.courseName}">ê°•ì˜ëª…</span>
      </div>
      <div class="meta-item">
        <span>ğŸ“…</span>
        <span th:text="'ë“±ë¡ì¼: ' + ${#temporals.format(assignment.createdDate, 'yyyy-MM-dd HH:mm')}">ë“±ë¡ì¼</span>
      </div>
      <div class="meta-item">
        <span>â°</span>
        <span th:text="'ë§ˆê°ì¼: ' + ${#temporals.format(assignment.dueDate, 'yyyy-MM-dd HH:mm')}">ë§ˆê°ì¼</span>
      </div>
    </div>
    <div class="assignment-description" th:text="${assignment.content}">ê³¼ì œ ì„¤ëª…</div>
  </div>

  <!-- Statistics -->
  <div class="stats-cards">
    <div class="stat-card">
      <div class="stat-number" th:text="${#lists.size(submissions)}">0</div>
      <div class="stat-label">ì´ ì œì¶œë¬¼</div>
    </div>
    <div class="stat-card">
      <div class="stat-number" th:text="${submissions != null ? #lists.size(submissions.?[score != null]) : '0'}">0</div>
      <div class="stat-label">ì±„ì  ì™„ë£Œ</div>
    </div>
    <div class="stat-card">
      <div class="stat-number" th:text="${submissions != null ? #lists.size(submissions.?[score == null]) : '0'}">0</div>
      <div class="stat-label">ì±„ì  ëŒ€ê¸°</div>
    </div>
    <div class="stat-card">
      <div class="stat-number" th:text="${submissions != null and !#lists.isEmpty(submissions.?[score != null]) ? (#numbers.formatDecimal((#aggregates.sum(submissions.?[score != null].![score]) / #lists.size(submissions.?[score != null])), 1, 1)) : '0.0'}">0.0</div>
      <div class="stat-label">í‰ê·  ì ìˆ˜</div>
    </div>
  </div>

  <!-- Submissions Table -->
  <div class="submissions-table">
    <div class="table-header">
      <div class="table-title">ì œì¶œë¬¼ ëª©ë¡</div>
    </div>

    <div th:if="${#lists.isEmpty(submissions)}" class="empty-state">
      <div class="empty-state-icon">ğŸ“‹</div>
      <h3>ì œì¶œëœ ê³¼ì œê°€ ì—†ìŠµë‹ˆë‹¤</h3>
      <p>ì•„ì§ í•™ìƒë“¤ì´ ê³¼ì œë¥¼ ì œì¶œí•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>
    </div>

    <table th:unless="${#lists.isEmpty(submissions)}">
      <thead>
      <tr>
        <th>í•™ìƒ</th>
        <th>ì œì¶œì¼ì‹œ</th>
        <th>ìƒíƒœ</th>
        <th>ì ìˆ˜</th>
        <th>ê´€ë¦¬</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="submission : ${submissions}">
        <td>
          <div class="student-info">
            <div class="student-avatar" th:text="${submission.student.name.substring(0,1)}">í•™</div>
            <div class="student-details">
              <div class="student-name" th:text="${submission.student.name}">í•™ìƒëª…</div>
              <div class="student-id" th:text="${submission.student.studentId}">í•™ë²ˆ</div>
            </div>
          </div>
        </td>
        <td th:text="${#temporals.format(submission.submissionTime, 'yyyy-MM-dd HH:mm')}">ì œì¶œì¼ì‹œ</td>
        <td>
          <span th:if="${submission.score != null}" class="submission-status status-graded">ì±„ì ì™„ë£Œ</span>
          <span th:if="${submission.score == null and submission.submissionTime.isBefore(assignment.dueDate)}"
                class="submission-status status-submitted">ì œì¶œì™„ë£Œ</span>
          <span th:if="${submission.score == null and submission.submissionTime.isAfter(assignment.dueDate)}"
                class="submission-status status-late">ì§€ê°ì œì¶œ</span>
        </td>
        <td>
                        <span th:if="${submission.score != null}"
                              th:class="${'score-display ' + (submission.score >= 90 ? 'score-good' : (submission.score >= 70 ? 'score-average' : 'score-poor'))}"
                              th:text="${submission.score + 'ì '}">ì ìˆ˜</span>
          <span th:if="${submission.score == null}" class="submission-status" style="background: #e9ecef; color: #6c757d;">ë¯¸ì±„ì </span>
        </td>
        <td>
          <a th:href="@{'/professor/submission/' + ${submission.submissionCode}}" class="action-btn">
            ğŸ“ ì±„ì í•˜ê¸°
          </a>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>
</body>
</html>